<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Patient Info</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body class="bg-light">

<div class="container mt-5">
  <div class="card shadow">
    <div class="card-header bg-primary text-white">
      <h3>Patient Information</h3>
    </div>
    <div class="card-body" id="patient-info">
      <p><strong>Name:</strong> <span id="name"></span> <span id="last_name"></span></p>
      <p><strong>Room:</strong> <span id="room"></span></p>
      <p><strong>Contact:</strong> <span id="contact"></span></p>
      <p><strong>Illness:</strong> <span id="illness"></span></p>
      <p><strong>Date Admitted:</strong> <span id="date_admitted"></span></p>
      <p><strong>IV Bag Type:</strong> <span id="ivbag_type"></span></p>
      <p><strong>IV Bag Level:</strong> <span id="ivbag_level"></span>%</p>
      <p><strong>Backflow:</strong> <span id="backflow"></span></p>
      <p><strong>Status:</strong> <span id="active_status"></span></p>
      <p><strong>MAC Address:</strong> <span id="mac"></span></p>
      <p><strong>IP Address:</strong> <span id="ipAddress"></span></p>
      <p><strong>Watcher:</strong> <span id="watcher"></span></p>
    </div>
  </div>
</div>

<script>
function getMacFromURL() {
  const path = window.location.pathname.split('/');
  return path[path.length - 1] || ''; // Get last part of the URL
}

const mac = getMacFromURL();
document.getElementById('mac').textContent = mac;
const url = `https://ivbag-c6fd2-default-rtdb.firebaseio.com/bag_info/${mac}.json`;

function fetchData() {
  fetch(url)
    .then(res => res.json())
    .then(data => {
      if (!data) return;
      document.getElementById('name').textContent = data.name || '';
      document.getElementById('last_name').textContent = data.last_name || '';
      document.getElementById('room').textContent = data.room || '';
      document.getElementById('contact').textContent = data.contact || '';
      document.getElementById('illness').textContent = data.illness || '';
      document.getElementById('date_admitted').textContent = data.date_admitted || '';
      document.getElementById('ivbag_type').textContent = data.ivbag_type || '';
      document.getElementById('ivbag_level').textContent = data.ivbag_level || '';
      document.getElementById('backflow').textContent = data.backflow ? 'Yes' : 'No';
      document.getElementById('active_status').textContent = data.active_status ? 'Active' : 'Inactive';
      document.getElementById('ipAddress').textContent = data.ipAddress || '';
      document.getElementById('watcher').textContent = data.watcher || '';
    });
}

// Load once + refresh every 5 seconds
fetchData();
setInterval(fetchData, 5000);
</script>

</body>
</html>
